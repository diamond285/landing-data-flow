{"ast":null,"code":"import axios from 'axios';\nimport $storage from \"@/storage\";\nconst ERROR_STATUSES = {\n  NOT_AUTHORIZED: 401,\n  FORBIDDEN: 403\n};\nconst instance = axios.create({\n  baseURL: \"http://localhost:8080\"\n});\ninstance.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\nconst auth_token = $storage.local_storage.get('auth_token');\nif (auth_token) {\n  instance.defaults.headers.common.Authorization = `${auth_token}`;\n}\nconst errorHandler = error => {\n  const {\n    status\n  } = errorHandler.response;\n  if ($storage.local_storage.get('auth_token') || status === ERROR_STATUSES.NOT_AUTHORIZED) {\n    $storage.local_storage.remove('auth_token');\n    delete instance.defaults.headers.common.Authorization;\n  }\n  throw error;\n};\nexport const request = (method, url, data = {}, options = {}) => {\n  if (options.isFile) {\n    instance.defaults.headers.common['Content-Type'] = 'multipart/form-data';\n  }\n  let responseType = 'json';\n  if (options.isBlob) {\n    responseType = 'blob';\n  }\n  return instance({\n    method,\n    url: url,\n    ...data,\n    responseType,\n    headers: {\n      ...options.headers\n    }\n  }).catch(errorHandler);\n};\nexport const login = token => {\n  $storage.local_storage.remove('auth_token');\n  $storage.local_storage.set('auth_token', token);\n  instance.defaults.headers.common.Authorization = `${token}`;\n  //window.location.href = `${window.location.origin}${reload_url}`;\n};\n\nexport const logout = () => {\n  $storage.local_storage.remove('auth_token');\n  window.local.reload();\n};","map":{"version":3,"names":["axios","$storage","ERROR_STATUSES","NOT_AUTHORIZED","FORBIDDEN","instance","create","baseURL","defaults","headers","common","auth_token","local_storage","get","Authorization","errorHandler","error","status","response","remove","request","method","url","data","options","isFile","responseType","isBlob","catch","login","token","set","logout","window","local","reload"],"sources":["/Users/baur/WebstormProjects/docs-flow-front/src/service/utils.js"],"sourcesContent":["import axios from 'axios'\nimport $storage from \"@/storage\";\n\n\n\nconst ERROR_STATUSES = { NOT_AUTHORIZED: 401, FORBIDDEN: 403 };\n\nconst instance = axios.create({baseURL: \"http://localhost:8080\"})\n\ninstance.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n\nconst auth_token = $storage.local_storage.get('auth_token')\nif (auth_token) {\n    instance.defaults.headers.common.Authorization = `${auth_token}`;\n}\n\nconst errorHandler = (error) => {\n    const { status } = errorHandler.response\n    if ($storage.local_storage.get('auth_token') || status === ERROR_STATUSES.NOT_AUTHORIZED) {\n        $storage.local_storage.remove('auth_token');\n        delete instance.defaults.headers.common.Authorization;\n    }\n    throw error;\n}\n\nexport const request = (method, url, data = {}, options = {}) => {\n    if (options.isFile) {\n        instance.defaults.headers.common['Content-Type'] = 'multipart/form-data';\n    }\n    let responseType = 'json';\n    if (options.isBlob) {\n        responseType = 'blob';\n    }\n    return instance({\n        method, url: url, ...data, responseType, headers: { ...options.headers },\n    }).catch(errorHandler);\n}\n\nexport const login = (token) => {\n    $storage.local_storage.remove('auth_token');\n    $storage.local_storage.set('auth_token', token)\n    instance.defaults.headers.common.Authorization = `${token}`;\n    //window.location.href = `${window.location.origin}${reload_url}`;\n}\n\nexport const logout = () => {\n    $storage.local_storage.remove('auth_token');\n    window.local.reload();\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,QAAQ,MAAM,WAAW;AAIhC,MAAMC,cAAc,GAAG;EAAEC,cAAc,EAAE,GAAG;EAAEC,SAAS,EAAE;AAAI,CAAC;AAE9D,MAAMC,QAAQ,GAAGL,KAAK,CAACM,MAAM,CAAC;EAACC,OAAO,EAAE;AAAuB,CAAC,CAAC;AAEjEF,QAAQ,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,6BAA6B,CAAC,GAAG,GAAG;AAErE,MAAMC,UAAU,GAAGV,QAAQ,CAACW,aAAa,CAACC,GAAG,CAAC,YAAY,CAAC;AAC3D,IAAIF,UAAU,EAAE;EACZN,QAAQ,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAACI,aAAa,GAAI,GAAEH,UAAW,EAAC;AACpE;AAEA,MAAMI,YAAY,GAAIC,KAAK,IAAK;EAC5B,MAAM;IAAEC;EAAO,CAAC,GAAGF,YAAY,CAACG,QAAQ;EACxC,IAAIjB,QAAQ,CAACW,aAAa,CAACC,GAAG,CAAC,YAAY,CAAC,IAAII,MAAM,KAAKf,cAAc,CAACC,cAAc,EAAE;IACtFF,QAAQ,CAACW,aAAa,CAACO,MAAM,CAAC,YAAY,CAAC;IAC3C,OAAOd,QAAQ,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAACI,aAAa;EACzD;EACA,MAAME,KAAK;AACf,CAAC;AAED,OAAO,MAAMI,OAAO,GAAG,CAACC,MAAM,EAAEC,GAAG,EAAEC,IAAI,GAAG,CAAC,CAAC,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;EAC7D,IAAIA,OAAO,CAACC,MAAM,EAAE;IAChBpB,QAAQ,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,cAAc,CAAC,GAAG,qBAAqB;EAC5E;EACA,IAAIgB,YAAY,GAAG,MAAM;EACzB,IAAIF,OAAO,CAACG,MAAM,EAAE;IAChBD,YAAY,GAAG,MAAM;EACzB;EACA,OAAOrB,QAAQ,CAAC;IACZgB,MAAM;IAAEC,GAAG,EAAEA,GAAG;IAAE,GAAGC,IAAI;IAAEG,YAAY;IAAEjB,OAAO,EAAE;MAAE,GAAGe,OAAO,CAACf;IAAQ;EAC3E,CAAC,CAAC,CAACmB,KAAK,CAACb,YAAY,CAAC;AAC1B,CAAC;AAED,OAAO,MAAMc,KAAK,GAAIC,KAAK,IAAK;EAC5B7B,QAAQ,CAACW,aAAa,CAACO,MAAM,CAAC,YAAY,CAAC;EAC3ClB,QAAQ,CAACW,aAAa,CAACmB,GAAG,CAAC,YAAY,EAAED,KAAK,CAAC;EAC/CzB,QAAQ,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAACI,aAAa,GAAI,GAAEgB,KAAM,EAAC;EAC3D;AACJ,CAAC;;AAED,OAAO,MAAME,MAAM,GAAG,MAAM;EACxB/B,QAAQ,CAACW,aAAa,CAACO,MAAM,CAAC,YAAY,CAAC;EAC3Cc,MAAM,CAACC,KAAK,CAACC,MAAM,EAAE;AACzB,CAAC"},"metadata":{},"sourceType":"module"}